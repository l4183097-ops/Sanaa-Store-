<h2>ðŸ“¦ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h2>
<div id="orders"></div>

<script>

const TOKEN="PUT_TOKEN";
const REPO="USERNAME/REPO";

async function loadOrders(){

let res=await fetch("orders.json");
let orders=await res.json();

ordersDiv.innerHTML="";

orders.reverse().forEach(o=>{
ordersDiv.innerHTML+=`
<div style="background:#fff;margin:10px;padding:10px">
Ø·Ù„Ø¨ Ø±Ù‚Ù… ${o.id}<br>

<select onchange="updateStatus(${o.id},this.value)">
<option value="pending">Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</option>
<option value="preparing">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ø¶ÙŠØ±</option>
<option value="delivery">Ø®Ø±Ø¬ Ù„Ù„ØªÙˆØµÙŠÙ„</option>
<option value="done">ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„</option>
</select>

</div>`;
});
}

async function updateStatus(id,status){

let res=await fetch(
`https://api.github.com/repos/${REPO}/contents/orders.json`,
{headers:{Authorization:"token "+TOKEN}}
);

let data=await res.json();
let orders=JSON.parse(atob(data.content));

orders=orders.map(o=>{
if(o.id==id) o.status=status;
return o;
});

await fetch(
`https://api.github.com/repos/${REPO}/contents/orders.json`,
{
method:"PUT",
headers:{
Authorization:"token "+TOKEN,
"Content-Type":"application/json"
},
body:JSON.stringify({
message:"update status",
content:btoa(JSON.stringify(orders,null,2)),
sha:data.sha
})
});

alert("ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« âœ…");
}

loadOrders();
setInterval(loadOrders,5000);

</script>